dirs = ['0Jet', '1Jet', '2Jet', '2JetVBF']

drs = ['0jet', '1jet', '2jet_gg', '2jet_vbf']

samp = ['Zothers', 'W', 'EWK', 'ggH_htt', 'qqH_htt', 'ggH_hww', 'qqH_hww', 'TT', 'T', 'Diboson', 'LFVGG125', 'LFVVBF125']
#samp = ['Zothers', 'W', 'WG', 'EWK', 'ggH_htt', 'qqH_htt', 'ggH_hww', 'qqH_hww', 'vH_htt', 'TT', 'T', 'Diboson', 'LFVGG125', 'LFVVBF125']

recsamp = ['Zothers', 'W', 'EWK', 'ggH_htt', 'qqH_htt', 'ggH_hww', 'qqH_hww', 'LFVGG125', 'LFVVBF125']

norecsamp = ['WG', 'vH_htt', 'TT', 'T', 'Diboson']

qcdSys = ['Rate0JetUp/', 'Rate0JetDown/', 'Rate1JetUp/', 'Rate1JetDown/', 'Rate2JetUp/', 'Rate2JetDown/', 'Shape0JetUp/', 'Shape0JetDown/', 'Shape1JetUp/', 'Shape1JetDown/', 'Shape2JetUp/', 'Shape2JetDown/', 'IsoUp/', 'IsoDown/']

qcdSysNames = ['QCD_CMS_0JetRateUp', 'QCD_CMS_0JetRateDown', 'QCD_CMS_1JetRateUp', 'QCD_CMS_1JetRateDown', 'QCD_CMS_2JetRateUp', 'QCD_CMS_2JetRateDown', 'QCD_CMS_0JetShapeUp', 'QCD_CMS_0JetShapeDown', 'QCD_CMS_1JetShapeUp', 'QCD_CMS_1JetShapeDown', 'QCD_CMS_2JetShapeUp', 'QCD_CMS_2JetShapeDown', 'QCD_CMS_ExtrapolationUp', 'QCD_CMS_ExtrapolationDown']

escale = ['eescUp/', 'eescDown/']

escaleNames = [['ZTauTau_CMS_EESUp', 'ZTauTau_CMS_EES_embUp'], ['ZTauTau_CMS_EESDown', 'ZTauTau_CMS_EES_embDown']]

mcSys = ['puUp/', 'puDown/', 'pfUp/', 'pfDown/', 'bTagUp/', 'bTagDown/', 'eescUp/', 'eescDown/', 'mesUp/', 'mesDown/']

mcSysNames = ['_CMS_pileupUp', '_CMS_pileupDown', '_CMS_prefiringUp', '_CMS_prefiringDown', '_CMS_eff_bUp', '_CMS_eff_bDown', '_CMS_EESUp', '_CMS_EESDown', '_CMS_MESUp', '_CMS_MESDown']

recSys = ['recrespUp/', 'recrespDown/', 'recresoUp/', 'recresoDown/']

recSysNames = ['_CMS_RecoilResponseUp', '_CMS_RecoilResponseDown', '_CMS_RecoilResolutionUp', '_CMS_RecoilResolutionDown']

dyptSys = ['DYptreweightUp/', 'DYptreweightDown/']

dyptSysNames = ['_CMS_dyShapeUp', '_CMS_dyShapeDown']

ttSys = ['TopptreweightUp/', 'TopptreweightDown/']

ttSysNames = ['_CMS_TTpTreweightUp', '_CMS_TTpTreweightDown']

jesSys = ['UnclusteredEnUp/', 'UnclusteredEnDown/', 'UesCHARGEDUp/', 'UesCHARGEDDown/', 'UesECALUp/', 'UesECALDown/', 'UesHCALUp/', 'UesHCALDown/', 'UesHFUp/', 'UesHFDown/', 'JetAbsoluteFlavMapUp/', 'JetAbsoluteFlavMapDown/', 'JetAbsoluteMPFBiasUp/', 'JetAbsoluteMPFBiasDown/', 'JetAbsoluteScaleUp/', 'JetAbsoluteScaleDown/', 'JetAbsoluteStatUp/', 'JetAbsoluteStatDown/', 'JetFlavorQCDUp/', 'JetFlavorQCDDown/', 'JetFragmentationUp/', 'JetFragmentationDown/', 'JetPileUpDataMCUp/', 'JetPileUpDataMCDown/', 'JetPileUpPtBBUp/', 'JetPileUpPtBBDown/', 'JetPileUpPtEC1Up/', 'JetPileUpPtEC1Down/', 'JetPileUpPtEC2Up/', 'JetPileUpPtEC2Down/', 'JetPileUpPtHFUp/', 'JetPileUpPtHFDown/', 'JetPileUpPtRefUp/', 'JetPileUpPtRefDown/', 'JetRelativeFSRUp/', 'JetRelativeFSRDown/', 'JetRelativeJEREC1Up/', 'JetRelativeJEREC1Down/', 'JetRelativeJEREC2Up/', 'JetRelativeJEREC2Down/', 'JetRelativeJERHFUp/', 'JetRelativeJERHFDown/', 'JetRelativePtBBUp/', 'JetRelativePtBBDown/', 'JetRelativePtEC1Up/', 'JetRelativePtEC1Down/', 'JetRelativePtEC2Up/', 'JetRelativePtEC2Down/', 'JetRelativePtHFUp/', 'JetRelativePtHFDown/', 'JetRelativeStatECUp/', 'JetRelativeStatECDown/', 'JetRelativeStatFSRUp/', 'JetRelativeStatFSRDown/', 'JetRelativeStatHFUp/', 'JetRelativeStatHFDown/', 'JetSinglePionECALUp/', 'JetSinglePionECALDown/', 'JetSinglePionHCALUp/', 'JetSinglePionHCALDown/', 'JetTimePtEtaUp/', 'JetTimePtEtaDown/', 'JetRelativeBalUp/', 'JetRelativeBalDown/', 'JetRelativeSampleUp/', 'JetRelativeSampleDown/']

jesSysNames = ['_CMS_MET_UesUp', '_CMS_MET_UesDown', '_CMS_scale_met_chargedUp', '_CMS_scale_met_chargedDown', '_CMS_scale_met_ecalUp', '_CMS_scale_met_ecalDown', '_CMS_scale_met_hcalUp', '_CMS_scale_met_hcalDown', '_CMS_scale_met_hfUp', '_CMS_scale_met_hfDown', '_CMS_Jes_JetAbsoluteFlavMapUp', '_CMS_Jes_JetAbsoluteFlavMapDown', '_CMS_Jes_JetAbsoluteMPFBiasUp', '_CMS_Jes_JetAbsoluteMPFBiasDown', '_CMS_Jes_JetAbsoluteScaleUp', '_CMS_Jes_JetAbsoluteScaleDown', '_CMS_Jes_JetAbsoluteStatUp', '_CMS_Jes_JetAbsoluteStatDown', '_CMS_scale_j_FlavorQCDUp', '_CMS_scale_j_FlavorQCDDown', '_CMS_Jes_JetFragmentationUp', '_CMS_Jes_JetFragmentationDown', '_CMS_Jes_JetPileUpDataMCUp', '_CMS_Jes_JetPileUpDataMCDown', '_CMS_Jes_JetPileUpPtBBUp', '_CMS_Jes_JetPileUpPtBBDown', '_CMS_Jes_JetPileUpPtEC1Up', '_CMS_Jes_JetPileUpPtEC1Down', '_CMS_Jes_JetPileUpPtEC2Up', '_CMS_Jes_JetPileUpPtEC2Down', '_CMS_Jes_JetPileUpPtHFUp', '_CMS_Jes_JetPileUpPtHFDown', '_CMS_Jes_JetPileUpPtRefUp', '_CMS_Jes_JetPileUpPtRefDown', '_CMS_Jes_JetRelativeFSRUp', '_CMS_Jes_JetRelativeFSRDown', '_CMS_Jes_JetRelativeJEREC1Up', '_CMS_Jes_JetRelativeJEREC1Down', '_CMS_Jes_JetRelativeJEREC2Up', '_CMS_Jes_JetRelativeJEREC2Down', '_CMS_Jes_JetRelativeJERHFUp', '_CMS_Jes_JetRelativeJERHFDown', '_CMS_Jes_JetRelativePtBBUp', '_CMS_Jes_JetRelativePtBBDown', '_CMS_Jes_JetRelativePtEC1Up', '_CMS_Jes_JetRelativePtEC1Down', '_CMS_Jes_JetRelativePtEC2Up', '_CMS_Jes_JetRelativePtEC2Down', '_CMS_Jes_JetRelativePtHFUp', '_CMS_Jes_JetRelativePtHFDown', '_CMS_Jes_JetRelativeStatECUp', '_CMS_Jes_JetRelativeStatECDown', '_CMS_Jes_JetRelativeStatFSRUp', '_CMS_Jes_JetRelativeStatFSRDown', '_CMS_Jes_JetRelativeStatHFUp', '_CMS_Jes_JetRelativeStatHFDown', '_CMS_Jes_JetSinglePionECALUp', '_CMS_Jes_JetSinglePionECALDown', '_CMS_Jes_JetSinglePionHCALUp', '_CMS_Jes_JetSinglePionHCALDown', '_CMS_Jes_JetTimePtEtaUp', '_CMS_Jes_JetTimePtEtaDown', '_CMS_scale_j_RelativeBalUp', '_CMS_scale_j_RelativeBalDown', '_CMS_scale_j_RelativeSample_2016Up', '_CMS_scale_j_RelativeSample_2016Down']

mc_samples = ['DYJetsToLL_M-50*', 'DYJetsToLL_M-10to50*', 'DY1JetsToLL*', 'DY2JetsToLL*', 'DY3JetsToLL*', 'DY4JetsToLL*', 'W1JetsToLNu*', 'W2JetsToLNu*', 'W3JetsToLNu*', 'W4JetsToLNu*', 'WGToLNuG*', 'WJetsToLNu*', 'GluGlu_LFV*', 'VBF_LFV*', 'GluGluHToTauTau*', 'VBFHToTauTau*', 'GluGluHToWWTo2L2Nu*', 'VBFHToWWTo2L2Nu*', 'WminusHToTauTau*', 'WplusHToTauTau*', 'ZHToTauTau*', 'TTTo2L2Nu*', 'TTToSemiLeptonic*', 'TTToHadronic*', 'ST_tW_antitop*', 'ST_tW_top*', 'ST_t-channel_antitop*', 'ST_t-channel_top*', 'QCD*', 'WZ*', 'WW*', 'ZZ*', 'EWKWMinus2Jets*', 'EWKWPlus2Jets*', 'EWKZ2Jets_ZToLL*', 'EWKZ2Jets_ZToNuNu*', 'Embed*', 'MC*', 'data*', 'Obs*', 'Bac*']

histoname = [("mPt", "#mu  p_{T} (GeV)", 1), ("ePt", "e p_{T} (Gev)", 1), ("mEta", "#mu #eta", 1), ("eEta", "e #eta", 1), ("mPhi", "#mu #phi", 1), ("ePhi", "e #phi", 1), ("j1Pt", "Jet 1 p_{T}", 1), ("j2Pt", "Jet 2 p_{T}", 1), ("j1Eta", "Jet 1 #eta", 1), ("j2Eta", "Jet 2 #eta", 1), ("j1Phi", "Jet 1 #phi", 1), ("j2Phi", "Jet 2 #phi", 1), ("type1_pfMetEt", "MET (GeV)", 1), ("type1_pfMetPhi", "MET #phi", 1), ("e_m_Mass", "M_{vis}(e, #mu) (GeV)", 1), ("e_m_CollMass", "M_{col}(e, #mu) (GeV)", 1), ("e_m_PZeta", "p_{#zeta}(e, #mu) (GeV)", 1), ("numOfJets", "Number of Jets", 1), ("vbfMass", "VBF Mass", 1), ("numOfVtx", "Number of Vertices", 1), ("dEtaEMu", "#Delta#eta(e, #mu)", 1), ("dPhiEMET", "#Delta#phi(e, MET)", 1), ("dPhiMuMET", "#Delta#phi(#mu, MET)", 1), ("dPhiEMu", "#Delta#phi(e, #mu)", 1), ("MTEMET", "M_{T}(e, MET) (GeV)", 1), ("MTMuMET", "M_{T}(#mu, MET) (GeV)", 1)]

colhisto = [("e_m_CollinearMass", "M_{col}(e, #mu) (GeV)", 1)]

#bdthisto = [('e_m_Mass', 'm_{e#mu}',1)]
bdthisto = [("bdtDiscriminator", "BDT Discriminator", 1), ("bdtDiscriminator_scaledBkg", "atanh((1-BDT Discriminator)/2)", 1), ("bdtDiscriminator_scaledSig", "atanh((1+BDT Discriminator)/2)", 1)]
#bdthisto = [("mPt", "#mu  p_{T} (GeV)", 1), ("ePt", "e p_{T} (Gev)", 1),('emEta', 'Electron + Muon Eta', 1), ('DeltaEta_m_met', 'Delta Eta of Muon and MET',1), ('DeltaEta_e_met', 'Delta Eta of Electron and MET', 1), ('DeltaPhi_m_met', 'Delta Phi of Muon and MET', 1), ('MetEt', 'MET E_T',1), ('DeltaPhi_e_met', 'Delta Phi of Electron and MET',1), ('emPt', 'Electron + Muon Pt',1), ('ePt_Per_e_m_Mass', 'Electron pT per Electron +  Muon Mass',1),('e_met_mT', 'Electron + MET Transverse Mass',1),('mPt_Per_e_m_Mass', 'Muon pT per Electron + Muon Mass',1),('m_met_mT', 'Muon + MET Transverse Mass',1),('e_m_PZeta', 'Electron + Muon PZeta',1),('DeltaPhi_em_j1', 'Delta Phi of Electron and Leading Jet',1),('j1Pt', 'Leading Jet pT', 1),('DeltaEta_em_j1', 'Delta Eta of Electron + Muonand Leading Jet',1),('DeltaEta_em_j2', 'Delta Eta of Electron + Muon and Subleading Jet',1),('DeltaPhi_em_j2', 'Delta Phi of Electron + Muon and Subleading Jet',1),('DeltaEta_j1_j2', 'Delta Eta of Jets',1),('DeltaPhi_j1_j2', 'Delta Phi of Jets',1),('e_m_Mass', 'Electron + Muon Mass',1),('deltaR', 'DeltaR Electron and Muon',1)]

files = []

lumifiles = []

jet = ['', '0Jet', '1Jet', '2Jet', '2JetVBF']
jetc = ['', '0Jet', '1Jet', '2Jet', '2JetVBF', '0JetCut', '1JetCut', '2JetCut', '2JetVBFCut']

procs = ['gg']

def remove_name_entry(dictionary):
    return dict( [ i for i in dictionary.iteritems() if i[0] != 'name'] )

def positivize(histogram):
    output = histogram.Clone()
    for i in range(output.GetSize()):
        if output.GetArray()[i] < 0:
            output.AddAt(0, i)
    return output

def normQCD(histogram, i, category):
    qcd = histogram.Clone()
    if category=='0Jet':
        qcd.Scale(219.529/i)
    elif category=='1Jet':
        qcd.Scale(190.54/i)
    elif category=='2Jet':
        qcd.Scale(135.133/i)
    elif category=='2JetVBF':
        qcd.Scale(20.236/i)
    return qcd

def normQCDBDT(histogram, i, category):
    qcd = histogram.Clone()
    if category=='0Jet':
        qcd.Scale(19700.9/i)
    elif category=='1Jet':
        qcd.Scale(6904.8/i)
    elif category=='2Jet':
        qcd.Scale(1758.84/i)
    elif category=='2JetVBF':
        qcd.Scale(366.696/i)
    return qcd
